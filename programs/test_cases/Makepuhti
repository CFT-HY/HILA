OPTS = -DNDIM=2 

CC = gcc 
CXX = c++ -std=c++17

CFLAGS = -O3 $(OPTS)
CXXFLAGS = -O3 $(OPTS)

#add test excecutables as dependents to test and pass them to test.sh

test_baseline: Makefile conjReduce
	./testPuhti.sh conjReduce

conjReduce: Makefile conjReduce.o mersenne_inline.o lattice.o memory.o setup_layout_generic.o map_node_layout_trivial.o
	$(CC) -o conjReduce conjReduce.o mersenne_inline.o lattice.o memory.o setup_layout_generic.o map_node_layout_trivial.o 

conjReduce.o: conjReduce.cpt
	$(CXX) $(CXXFLAGS) $< -c

%.o : %.cpt
	$(CXX) $(CXXFLAGS) $< -c

%.o : ../plumbing/%.cpp
	$(CXX) $(CXXFLAGS) $< -c

%.o : %.c
	$(CC) $(CFLAGS) $< -c

clean:
	rm -rf conjReduce

cleanall:
	rm -rf conjReduce 
	rm -rf *.o
