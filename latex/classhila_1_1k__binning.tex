\doxysection{hila\+::k\+\_\+binning Class Reference}
\hypertarget{classhila_1_1k__binning}{}\label{classhila_1_1k__binning}\index{hila::k\_binning@{hila::k\_binning}}


{\ttfamily \#include $<$spectraldensity.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classhila_1_1k__binning_ac06dad930f9f5085739fd499080891df}\label{classhila_1_1k__binning_ac06dad930f9f5085739fd499080891df} 
\mbox{\hyperlink{classhila_1_1k__binning}{k\+\_\+binning}} \& {\bfseries bins} (int n)
\begin{DoxyCompactList}\small\item\em Set number of bins in histogram. \end{DoxyCompactList}\item 
\Hypertarget{classhila_1_1k__binning_a3a5a5714b2b41dabb3dcfe70da433cda}\label{classhila_1_1k__binning_a3a5a5714b2b41dabb3dcfe70da433cda} 
\mbox{\hyperlink{classhila_1_1k__binning}{k\+\_\+binning}} \& {\bfseries k\+\_\+max} (double km)
\begin{DoxyCompactList}\small\item\em Max value of k. \end{DoxyCompactList}\item 
\Hypertarget{classhila_1_1k__binning_aab63176f8a8c639f2e60c6246917e23f}\label{classhila_1_1k__binning_aab63176f8a8c639f2e60c6246917e23f} 
\mbox{\hyperlink{classhila_1_1k__binning}{k\+\_\+binning}} \& {\bfseries power} (double p)
\begin{DoxyCompactList}\small\item\em Bin quantity k\texorpdfstring{$^\wedge$}{\string^}p. \end{DoxyCompactList}\item 
\Hypertarget{classhila_1_1k__binning_a3e9891b7e426c3928d0880baf928879f}\label{classhila_1_1k__binning_a3e9891b7e426c3928d0880baf928879f} 
\mbox{\hyperlink{classhila_1_1k__binning}{k\+\_\+binning}} \& {\bfseries exact\+\_\+bins} (int e)
\begin{DoxyCompactList}\small\item\em Bin exactly this many bins. \end{DoxyCompactList}\item 
\Hypertarget{classhila_1_1k__binning_a86acdba01d2aa76f743b7c5360c53889}\label{classhila_1_1k__binning_a86acdba01d2aa76f743b7c5360c53889} 
{\footnotesize template$<$typename T $>$ }\\std\+::vector$<$ T $>$ {\bfseries bin\+\_\+k\+\_\+field} (const \mbox{\hyperlink{classField}{Field}}$<$ T $>$ \&f)
\begin{DoxyCompactList}\small\item\em Generic k-\/space field binner routine -\/ returns field element type vector. \end{DoxyCompactList}\item 
\Hypertarget{classhila_1_1k__binning_af0224a8d19a4d352acbfc1f268ee4e14}\label{classhila_1_1k__binning_af0224a8d19a4d352acbfc1f268ee4e14} 
{\footnotesize template$<$typename T $>$ }\\std\+::vector$<$ double $>$ {\bfseries bin\+\_\+k\+\_\+field\+\_\+squarenorm} (const \mbox{\hyperlink{classField}{Field}}$<$ T $>$ \&f)
\begin{DoxyCompactList}\small\item\em sum up the square norm of all elements \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T , std\+::enable\+\_\+if\+\_\+t$<$ \mbox{\hyperlink{structhila_1_1contains__complex}{hila\+::contains\+\_\+complex}}$<$ T $>$\+::value, int $>$  = 0$>$ }\\std\+::vector$<$ double $>$ \mbox{\hyperlink{classhila_1_1k__binning_a0672572649ba03173ec71af9ed9f92ff}{spectraldensity}} (const \mbox{\hyperlink{classField}{Field}}$<$ T $>$ \&f)
\item 
\Hypertarget{classhila_1_1k__binning_a0672572649ba03173ec71af9ed9f92ff}\label{classhila_1_1k__binning_a0672572649ba03173ec71af9ed9f92ff} 
{\footnotesize template$<$typename T , std\+::enable\+\_\+if\+\_\+t$<$!\mbox{\hyperlink{structhila_1_1contains__complex}{hila\+::contains\+\_\+complex}}$<$ T $>$\+::value, int $>$  = 0$>$ }\\std\+::vector$<$ double $>$ {\bfseries spectraldensity} (const \mbox{\hyperlink{classField}{Field}}$<$ T $>$ \&f)
\begin{DoxyCompactList}\small\item\em interface for real fields -\/ an extra copy which could be avoided \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classhila_1_1k__binning_a312c235decfb987761057065186bd07c}{sd\+\_\+calculate\+\_\+bin\+\_\+info}} ()
\item 
\Hypertarget{classhila_1_1k__binning_aab0dfb1fece7d95a9a09bdff01c95c1e}\label{classhila_1_1k__binning_aab0dfb1fece7d95a9a09bdff01c95c1e} 
double {\bfseries k} (int i)
\begin{DoxyCompactList}\small\item\em Get the average k-\/value of bin i. \end{DoxyCompactList}\item 
\Hypertarget{classhila_1_1k__binning_ad9db17d94efca74bedaaadbf3f21c2d9}\label{classhila_1_1k__binning_ad9db17d94efca74bedaaadbf3f21c2d9} 
long {\bfseries count} (int i)
\begin{DoxyCompactList}\small\item\em get the count of points within bin i \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classhila_1_1k__binning_a7ebf9f887401e952a1deadab9d6be750}{bin\+\_\+min}} (int i)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
class \doxylink{classhila_1_1k__binning}{hila\+::k\+\_\+binning} is used to bin \"{}k-\/space\"{} fields (typically fourier transformed from real space). Vector k is normalized so that -\/pi \texorpdfstring{$<$}{<} k\+\_\+i \texorpdfstring{$<$}{<}= pi, i.\+e. coordinate. Bin is determined by formula b = (int) ( pow(k/k\+\_\+max)\texorpdfstring{$^\wedge$}{\string^}p \texorpdfstring{$\ast$}{*} n\+\_\+bins )

\doxylink{classhila_1_1k__binning}{hila\+::k\+\_\+binning} kb; kb.\+bins(80).k\+\_\+max(\+M\+\_\+\+PI); auto sd = kb.\+spectraldensity(f); // get the spectral density of field f

methods\+: (use as kb.\+xxx) \doxylink{classhila_1_1k__binning}{hila\+::k\+\_\+binning} \& \doxylink{classhila_1_1k__binning_ac06dad930f9f5085739fd499080891df}{bins(int n)} set number of bins int bins() get number of bins \doxylink{classhila_1_1k__binning}{hila\+::k\+\_\+binning} \& \doxylink{classhila_1_1k__binning_a3a5a5714b2b41dabb3dcfe70da433cda}{k\+\_\+max(double m)} set max value of k in binning double k\+\_\+max() get max value of k \doxylink{classhila_1_1k__binning}{hila\+::k\+\_\+binning} \& \doxylink{classhila_1_1k__binning_aab63176f8a8c639f2e60c6246917e23f}{power(double p)} set the \"{}power\"{} in binning double power() get power

std\+::vector$<$\+T$>$ \doxylink{classhila_1_1k__binning_a86acdba01d2aa76f743b7c5360c53889}{bin\+\_\+k\+\_\+field(const Field$<$\+T$>$ \&f)} bin the k-\/space field f std\+::vector$<$double$>$ bin\+\_\+k\+\_\+field\+\_\+squarenorm(const Field$<$\+T \& f) bin the square norm of k-\/space field f std\+::vector$<$double$>$ \doxylink{classhila_1_1k__binning_a0672572649ba03173ec71af9ed9f92ff}{spectraldensity(const Field$<$\+T$>$ \&f)} FFT real-\/space field f and bin the result in squarenorm

double \doxylink{classhila_1_1k__binning_aab0dfb1fece7d95a9a09bdff01c95c1e}{k(int b)} return the average k within bin b long \doxylink{classhila_1_1k__binning_ad9db17d94efca74bedaaadbf3f21c2d9}{count(int b)} return the number of points within bin b double \doxylink{classhila_1_1k__binning_a7ebf9f887401e952a1deadab9d6be750}{bin\+\_\+min(int b)} return the minimum k of bin b double bin\+\_\+max(int b) maximum k in bin b 

Definition at line \mbox{\hyperlink{spectraldensity_8h_source_l00065}{65}} of file \mbox{\hyperlink{spectraldensity_8h_source}{spectraldensity.\+h}}.



\doxysubsection{Member Function Documentation}
\Hypertarget{classhila_1_1k__binning_a7ebf9f887401e952a1deadab9d6be750}\label{classhila_1_1k__binning_a7ebf9f887401e952a1deadab9d6be750} 
\index{hila::k\_binning@{hila::k\_binning}!bin\_min@{bin\_min}}
\index{bin\_min@{bin\_min}!hila::k\_binning@{hila::k\_binning}}
\doxysubsubsection{\texorpdfstring{bin\_min()}{bin\_min()}}
{\footnotesize\ttfamily double hila\+::k\+\_\+binning\+::bin\+\_\+min (\begin{DoxyParamCaption}\item[{int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Bin limits bin is b = floor((k / k\+\_\+max)\texorpdfstring{$^\wedge$}{\string^}p \texorpdfstring{$\ast$}{*} n\+\_\+bins) thus, k\+\_\+min(b) = (b/n\+\_\+bins)\texorpdfstring{$^\wedge$}{\string^}(1/p) \texorpdfstring{$\ast$}{*} k\+\_\+max 

Definition at line \mbox{\hyperlink{spectraldensity_8h_source_l00307}{307}} of file \mbox{\hyperlink{spectraldensity_8h_source}{spectraldensity.\+h}}.

\Hypertarget{classhila_1_1k__binning_a312c235decfb987761057065186bd07c}\label{classhila_1_1k__binning_a312c235decfb987761057065186bd07c} 
\index{hila::k\_binning@{hila::k\_binning}!sd\_calculate\_bin\_info@{sd\_calculate\_bin\_info}}
\index{sd\_calculate\_bin\_info@{sd\_calculate\_bin\_info}!hila::k\_binning@{hila::k\_binning}}
\doxysubsubsection{\texorpdfstring{sd\_calculate\_bin\_info()}{sd\_calculate\_bin\_info()}}
{\footnotesize\ttfamily void hila\+::k\+\_\+binning\+::sd\+\_\+calculate\+\_\+bin\+\_\+info (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Data structure to hold the binning info -\/ two vectors, holding average k value in a bin and count of lattice points 

Definition at line \mbox{\hyperlink{spectraldensity_8h_source_l00248}{248}} of file \mbox{\hyperlink{spectraldensity_8h_source}{spectraldensity.\+h}}.

\Hypertarget{classhila_1_1k__binning_a0672572649ba03173ec71af9ed9f92ff}\label{classhila_1_1k__binning_a0672572649ba03173ec71af9ed9f92ff} 
\index{hila::k\_binning@{hila::k\_binning}!spectraldensity@{spectraldensity}}
\index{spectraldensity@{spectraldensity}!hila::k\_binning@{hila::k\_binning}}
\doxysubsubsection{\texorpdfstring{spectraldensity()}{spectraldensity()}}
{\footnotesize\ttfamily template$<$typename T , std\+::enable\+\_\+if\+\_\+t$<$ \mbox{\hyperlink{structhila_1_1contains__complex}{hila\+::contains\+\_\+complex}}$<$ T $>$\+::value, int $>$  = 0$>$ \\
std\+::vector$<$ double $>$ hila\+::k\+\_\+binning\+::spectraldensity (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classField}{Field}}$<$ T $>$ \&}]{f }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Spectral density This version takes in complex field 

Definition at line \mbox{\hyperlink{spectraldensity_8h_source_l00202}{202}} of file \mbox{\hyperlink{spectraldensity_8h_source}{spectraldensity.\+h}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
spectraldensity.\+h\end{DoxyCompactItemize}
