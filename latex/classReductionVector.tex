\doxysection{Reduction\+Vector\texorpdfstring{$<$}{<} T \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{classReductionVector}{}\label{classReductionVector}\index{ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}}


{\ttfamily \#include $<$reductionvector.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classReductionVector_a15f3e0855ba6f2a4b348baec90d3fd0f}{Reduction\+Vector}} ()=default
\item 
\Hypertarget{classReductionVector_a7e34603cd08bc221798da21c8aacf87b}\label{classReductionVector_a7e34603cd08bc221798da21c8aacf87b} 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Reduction\+Vector} ()
\begin{DoxyCompactList}\small\item\em Destructor cleans up communications if they are in progress. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_a11af974f6b54fa375136d7e06b8fbd61}\label{classReductionVector_a11af974f6b54fa375136d7e06b8fbd61} 
T \& {\bfseries operator\mbox{[}$\,$\mbox{]}} (const int i)
\begin{DoxyCompactList}\small\item\em And access operators -\/ these do in practice everything already! \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_ac911c3816ec5d53a840de509eecb7b5a}\label{classReductionVector_ac911c3816ec5d53a840de509eecb7b5a} 
\mbox{\hyperlink{classReductionVector}{Reduction\+Vector}} \& {\bfseries allreduce} (bool b=true)
\begin{DoxyCompactList}\small\item\em \doxylink{classReductionVector_ac911c3816ec5d53a840de509eecb7b5a}{allreduce(bool)} turns allreduce on or off. By default on. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_a9c6eb143ac0f86d2658bb5ffcd6e7d53}\label{classReductionVector_a9c6eb143ac0f86d2658bb5ffcd6e7d53} 
\mbox{\hyperlink{classReductionVector}{Reduction\+Vector}} \& {\bfseries nonblocking} (bool b=true)
\begin{DoxyCompactList}\small\item\em \doxylink{classReductionVector_a9c6eb143ac0f86d2658bb5ffcd6e7d53}{nonblocking(bool)} turns allreduce on or off. By default on. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_a1612a21f2b6c46d5aff27c66b4d34e88}\label{classReductionVector_a1612a21f2b6c46d5aff27c66b4d34e88} 
\mbox{\hyperlink{classReductionVector}{Reduction\+Vector}} \& {\bfseries delayed} (bool b=true)
\begin{DoxyCompactList}\small\item\em deferred(bool) turns deferred on or off. By default turns on. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename S , std\+::enable\+\_\+if\+\_\+t$<$ std\+::is\+\_\+assignable$<$ T \&, S $>$\+::value, int $>$  = 0$>$ }\\void \mbox{\hyperlink{classReductionVector_a92b21ed7cffa8543824d83240057188d}{operator=}} (const S \&rhs)
\item 
\Hypertarget{classReductionVector_aa0e9a58898f88587a49b1091b357d048}\label{classReductionVector_aa0e9a58898f88587a49b1091b357d048} 
void {\bfseries operator=} (std\+::nullptr\+\_\+t np)
\begin{DoxyCompactList}\small\item\em Assignment from 0. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_abe9c61e61832a132b13bfa9860050f98}\label{classReductionVector_abe9c61e61832a132b13bfa9860050f98} 
void {\bfseries init\+\_\+sum} ()
\begin{DoxyCompactList}\small\item\em Init is to be called before every site loop. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_a758109b7a8c57d6e16cf33d42730bb83}\label{classReductionVector_a758109b7a8c57d6e16cf33d42730bb83} 
void {\bfseries init\+\_\+product} ()
\begin{DoxyCompactList}\small\item\em Init is to be called before every site loop. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classReductionVector_a2465807617aa8778eff49493ff2aa763}{reduce\+\_\+sum}} ()
\item 
void \mbox{\hyperlink{classReductionVector_ae62d1f2b90d13b653a8c695aa9caa73f}{reduce\+\_\+product}} ()
\item 
\Hypertarget{classReductionVector_acc78b083e9ae017428867e4ebdbd33cd}\label{classReductionVector_acc78b083e9ae017428867e4ebdbd33cd} 
void {\bfseries wait} ()
\begin{DoxyCompactList}\small\item\em Wait for MPI to complete, if it is currently going on. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_a5f39a88de683c52f873ea2d0e2681cac}\label{classReductionVector_a5f39a88de683c52f873ea2d0e2681cac} 
void {\bfseries reduce} ()
\begin{DoxyCompactList}\small\item\em For delayed reduction, reduce starts or completes the reduction operation. \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_af639fbe7e9757e1a12ca432c1f16432f}\label{classReductionVector_af639fbe7e9757e1a12ca432c1f16432f} 
T \texorpdfstring{$\ast$}{*} {\bfseries data} ()
\begin{DoxyCompactList}\small\item\em \doxylink{classReductionVector_af639fbe7e9757e1a12ca432c1f16432f}{data()} returns ptr to the raw storage \end{DoxyCompactList}\item 
\Hypertarget{classReductionVector_a13d010107e0b38e2e142c2fcbca33d1e}\label{classReductionVector_a13d010107e0b38e2e142c2fcbca33d1e} 
size\+\_\+t {\bfseries size} () const
\begin{DoxyCompactList}\small\item\em methods from std\+::vector\+: \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename T$>$\newline
class Reduction\+Vector$<$ T $>$}
Special reduction class for arrays\+: declare a reduction array as Reduction\+Vector$<$\+T$>$ a(size);

This can be used within site loops as onsites(\+ALL ) \{ int i = ... a\mbox{[}i\mbox{]} += ... \}

or outside site loops as usual. Reductions\+: += \texorpdfstring{$\ast$}{*}= sum or product reduction NOTE\+: size of the reduction vector must be same on all nodes! By default reduction is \"{}allreduce\"{}, i.\+e. all nodes get the same result.

\doxylink{classReduction}{Reduction} can be customized by using methods\+: a.\+size() \+: return the size of the array a.\+resize(new\+\_\+size) \+: change size of array (all nodes must use same size!) a\mbox{[}i\mbox{]} \+: get/set element i

a.\+allreduce(bool) \+: turn allreduce on/off (default=true) a.\+nonblocking(bool) \+: turn non-\/blocking reduction on/off a.\+delayed(bool) \+: turn delayed reduction on/off

a.\+wait() \+: for non-\/blocking reduction, \doxylink{classReductionVector_acc78b083e9ae017428867e4ebdbd33cd}{wait()} has to be called after the loop to complete the reduction a.\+reduce() \+: for delayed reduction starts/completes the reduction

a.\+is\+\_\+allreduce() \+: queries the reduction status is\+\_\+nonblocking() is\+\_\+delayed()

a.\+push\+\_\+back(element) \+: add one element to The same reduction variable can be used again 

Definition at line \mbox{\hyperlink{reductionvector_8h_source_l00044}{44}} of file \mbox{\hyperlink{reductionvector_8h_source}{reductionvector.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classReductionVector_a15f3e0855ba6f2a4b348baec90d3fd0f}\label{classReductionVector_a15f3e0855ba6f2a4b348baec90d3fd0f} 
\index{ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}!ReductionVector@{ReductionVector}}
\index{ReductionVector@{ReductionVector}!ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{ReductionVector()}{ReductionVector()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{classReductionVector}{Reduction\+Vector}}$<$ T $>$\mbox{\hyperlink{classReductionVector}{\+::\+Reduction\+Vector}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}, {\ttfamily [default]}}

Initialize to zero by default (? exception to other variables) allreduce = true by default 

\doxysubsection{Member Function Documentation}
\Hypertarget{classReductionVector_a92b21ed7cffa8543824d83240057188d}\label{classReductionVector_a92b21ed7cffa8543824d83240057188d} 
\index{ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}!operator=@{operator=}}
\index{operator=@{operator=}!ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
template$<$typename S , std\+::enable\+\_\+if\+\_\+t$<$ std\+::is\+\_\+assignable$<$ T \&, S $>$\+::value, int $>$  = 0$>$ \\
void \mbox{\hyperlink{classReductionVector}{Reduction\+Vector}}$<$ T $>$\+::operator= (\begin{DoxyParamCaption}\item[{const S \&}]{rhs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Assignment is used only outside site loops -\/ wait for comms if needed Make this return void, hard to imagine it is used for anything useful 

Definition at line \mbox{\hyperlink{reductionvector_8h_source_l00184}{184}} of file \mbox{\hyperlink{reductionvector_8h_source}{reductionvector.\+h}}.

\Hypertarget{classReductionVector_ae62d1f2b90d13b653a8c695aa9caa73f}\label{classReductionVector_ae62d1f2b90d13b653a8c695aa9caa73f} 
\index{ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}!reduce\_product@{reduce\_product}}
\index{reduce\_product@{reduce\_product}!ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{reduce\_product()}{reduce\_product()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \mbox{\hyperlink{classReductionVector}{Reduction\+Vector}}$<$ T $>$\+::reduce\+\_\+product (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Product reduction -- currently works only for scalar data types. For \doxylink{classComplex}{Complex}, \doxylink{classMatrix}{Matrix} and Vector data product is not element-\/wise. TODO\+: \doxylink{classArray}{Array} or std\+::array ? TODO\+: implement using custom MPI ops (if needed) 

Definition at line \mbox{\hyperlink{reductionvector_8h_source_l00233}{233}} of file \mbox{\hyperlink{reductionvector_8h_source}{reductionvector.\+h}}.

\Hypertarget{classReductionVector_a2465807617aa8778eff49493ff2aa763}\label{classReductionVector_a2465807617aa8778eff49493ff2aa763} 
\index{ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}!reduce\_sum@{reduce\_sum}}
\index{reduce\_sum@{reduce\_sum}!ReductionVector$<$ T $>$@{ReductionVector$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{reduce\_sum()}{reduce\_sum()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \mbox{\hyperlink{classReductionVector}{Reduction\+Vector}}$<$ T $>$\+::reduce\+\_\+sum (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Start sum reduction -- works only if the type T addition == element-\/wise addition. This is true for all hila predefined data types 

Definition at line \mbox{\hyperlink{reductionvector_8h_source_l00217}{217}} of file \mbox{\hyperlink{reductionvector_8h_source}{reductionvector.\+h}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
reductionvector.\+h\end{DoxyCompactItemize}
