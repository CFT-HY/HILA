\chapter{Description and Installation}
\hypertarget{index}{}\label{index}\index{Description and Installation@{Description and Installation}}
\label{index_mainpage}%
\Hypertarget{index_mainpage}%


Hila (lattice in Finnish) is a C++ lattice field theory programming framework, aimed at HPC simulations. ~\newline


Purpose\+: make writing applications straightforward and intuitive, while producing optimized executables for different (super)computing platforms (parallelization with MPI, GPU computing with Cuda or HIP, AVX vectorization, etc.). Details of the parallelization and computing architecture are hidden from the user\textquotesingle{}s view, and all applications automatically run on present or future platform. Write once -- run anywhere.

Hila is based on hila preprocessor \"{}hilapp\"{}, which is a C++ source-\/to-\/source transformer using the \href{https://clang.llvm.org/docs/LibTooling.html}{\texttt{ libtooling}} toolbox of the \href{https://clang.llvm.org/}{\texttt{ Clang}} compiler. It converts application C++ to platform-\/specific C++ code, which is passed to appropriate compilers for the platforms.

Behind the scenes hila takes care of MPI layout and communications. It lays out the lattice fields differently for different computing platforms\+: \textquotesingle{}array of structures\textquotesingle{} (standard), \textquotesingle{}array of structures of vectors\textquotesingle{} (AVX-\/type), or \textquotesingle{}structure of arrays\textquotesingle{} (GPU-\/type).\hypertarget{index_autotoc_md7}{}\doxysection{\texorpdfstring{Table of Contents}{Table of Contents}}\label{index_autotoc_md7}

\begin{DoxyEnumerate}
\item \doxysectlink{index_dependencies}{Dependencies}{1}
\item \doxysectlink{index_installation}{Installation}{1}
\item \doxysectlink{index_user-guide}{User Guide}{1}
\end{DoxyEnumerate}\hypertarget{index_dependencies}{}\doxysection{\texorpdfstring{Dependencies}{Dependencies}}\label{index_dependencies}
\hypertarget{index_autotoc_md8}{}\doxysubsection{\texorpdfstring{Hilapp}{Hilapp}}\label{index_autotoc_md8}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Dependencies   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Minimum Version   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Required    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Dependencies   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Minimum Version   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Required    }\\\cline{1-3}
\endhead
Clang   &8 -\/   &Yes   \\\cline{1-3}
\end{longtabu}
\hypertarget{index_autotoc_md9}{}\doxysubsubsection{\texorpdfstring{Installing dependencies for HILA preprocessor\+:}{Installing dependencies for HILA preprocessor:}}\label{index_autotoc_md9}
If one opts to use a singularity container skip to HILA applications dependencies.

If one opts to use a docker container, skip directly to the \doxysectlink{index_installation}{installation}{1} section.

For building {\itshape hilapp}, you need \href{https://clang.llvm.org/}{\texttt{ clang}} development tools (actually, only include files). These can be found in most Linux distribution repos, e.\+g. in Ubuntu 22.\+04\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{export\ LLVM\_VERSION=15}
\DoxyCodeLine{sudo\ apt-\/get\ -\/y\ install\ clang-\/\$LLVM\_VERSION\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ libclang-\/\$LLVM\_VERSION-\/dev}

\end{DoxyCode}
\hypertarget{index_autotoc_md10}{}\doxysubsection{\texorpdfstring{HILA applications}{HILA applications}}\label{index_autotoc_md10}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Dependencies   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Minimum Version   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Required    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Dependencies   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Minimum Version   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Required    }\\\cline{1-3}
\endhead
Clang / GCC   &8 -\/ / x   &Yes    \\\cline{1-3}
FFTW3   &x   &Yes    \\\cline{1-3}
MPI   &x   &Yes    \\\cline{1-3}
Open\+MP   &x   &No    \\\cline{1-3}
CUDA   &x   &No    \\\cline{1-3}
HIP   &x   &No   \\\cline{1-3}
\end{longtabu}
\hypertarget{index_autotoc_md11}{}\doxysubsubsection{\texorpdfstring{Installing dependencies for HILA applications\+:}{Installing dependencies for HILA applications:}}\label{index_autotoc_md11}
If one opts to use docker, skip directly to the \doxysectlink{index_installation}{installation}{1} section.

Installing all non GPU dependencies on ubuntu\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{sudo\ apt\ install\ build-\/essential\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ libopenmpi-\/dev\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ libfftw3-\/dev\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ libomp-\/dev}

\end{DoxyCode}


{\bfseries{CUDA\+:}}

See NVIDIA drivers and CUDA documentation\+: \href{https://docs.nvidia.com/cuda/cuda-installation-guide-microsoft-windows/index.html}{\texttt{ https\+://docs.\+nvidia.\+com/cuda/cuda-\/installation-\/guide-\/microsoft-\/windows/index.\+html}}

{\bfseries{HIP\+:}}

See ROCm and HIP documentation\+: \href{https://docs.amd.com/}{\texttt{ https\+://docs.\+amd.\+com/}}, \href{https://rocmdocs.amd.com/en/latest/Installation_Guide/HIP-Installation.html}{\texttt{ https\+://rocmdocs.\+amd.\+com/en/latest/\+Installation\+\_\+\+Guide/\+HIP-\/\+Installation.\+html}}\hypertarget{index_installation}{}\doxysection{\texorpdfstring{Installation}{Installation}}\label{index_installation}
Begin by cloning HILA repository\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{git\ clone\ https://github.com/CFT-\/HY/HILA}

\end{DoxyCode}


The installation process is split into two parts. Building the HILA preprocessor and compiling HILA applications. Both can be installed from source, and both steps have their respective containerization options available. The variety in options is to address differing issues which arise in platform dependencies.

When it comes to installing HILA applications there are many avenues one can take depending on their platform. The available platforms and offered methods are listed below, which link to the necessary section in the installation guide.\hypertarget{index_autotoc_md12}{}\doxysubsubsection{\texorpdfstring{LINUX}{LINUX}}\label{index_autotoc_md12}
HILA has originally been developed on linux, hence all of the available options can be used. The HILA preprocessor can be built from \doxysectlink{index_hila-preprocessor}{source}{2} or with the use of a \doxysectlink{index_singularity}{singualrity}{3} container. Additionally one can opt to use the \doxysectlink{index_docker}{docker}{3} container which installs the hila preprocessor directly.\hypertarget{index_autotoc_md13}{}\doxysubsubsection{\texorpdfstring{MAC}{MAC}}\label{index_autotoc_md13}
On mac the installation of the HILA preprocessor dependencies and HILA application dependencies can be tedious, and in some cases impossible. Availability of clang libtoolbox is open ended. For this reason the best option is to use the available \doxysectlink{index_docker}{docker}{3} container.\hypertarget{index_autotoc_md14}{}\doxysubsubsection{\texorpdfstring{WINDOWS}{WINDOWS}}\label{index_autotoc_md14}
On windows the installation of the HILA preprocessor dependencies and HILA application dependencies are untested. For this reason the best option is to use the available \doxysectlink{index_docker}{docker}{3} container.\hypertarget{index_autotoc_md15}{}\doxysubsubsection{\texorpdfstring{HPC}{HPC}}\label{index_autotoc_md15}
On supercomputing platforms the HILA application dependencies are most likely available. The only issue is the availability of the clang libtoolbox which is used in building the HILA preprocessor. Due to the availability of singularity on supercomputing platfroms the best solution is to opt to use the \doxysectlink{index_singularity}{singularity}{3} container.

{\bfseries{After installing the hila preprocessor with one of the above options one can move on to the \doxysectlink{index_building-hila-applications}{building HILA applications}{2} section.}}\hypertarget{index_autotoc_md16}{}\doxysubsection{\texorpdfstring{Containers}{Containers}}\label{index_autotoc_md16}
HILA comes with both a singularity and docker container for differing purposes. The aim is to make use easy on any platform be it linux, mac, windows or a supercomputer.\hypertarget{index_docker}{}\doxysubsubsection{\texorpdfstring{Docker}{Docker}}\label{index_docker}
The docker container is meant to develop and produce HILA applications, libraries and hilapp with ease. One can produce HILA applications on their local machine and run them in a container without having to worry about dependencies. Note that there is overhead when running MPI communication in docker, thus one will not get optimal simulation performance when running highly paralelled code in a container. This is a non issue with small scale simulations or testing.

For instructions on using the docker container have a look at the \doxysectlink{md_docker_2README}{README.md}{0} in the docker folder\hypertarget{index_singularity}{}\doxysubsubsection{\texorpdfstring{Singularity}{Singularity}}\label{index_singularity}
The singularity container offers a more packaged approach where one doesn\textquotesingle{}t need to worry about clang libtoolbox support for compiling the HILA pre processor. Hence for HPC platforms where the access of such compiler libraries can be tedious one can simply opt to use the container version of hilapp. This approach is mainly meant to be used for pre processing applications on an HPC platform.

For instructions on installing singularity and building containers have a look at the \doxysectlink{md_singularity_2README}{README.md}{0} in the singularity folder\hypertarget{index_hila-preprocessor}{}\doxysubsection{\texorpdfstring{HILA preprocessor}{HILA preprocessor}}\label{index_hila-preprocessor}
Before building the preprocessor one must first install the dependencies. See the \doxysectlink{index_dependencies}{dependencies}{1}

Compile {\itshape hilapp}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{cd\ hila/hilapp}
\DoxyCodeLine{make\ [-\/j4]}
\DoxyCodeLine{make\ install}

\end{DoxyCode}


This builds {\itshape hilapp} in hila/hilapp/build, and {\ttfamily make install} moves it to hila/hilapp/bin, which is the default location for the program. Build takes 1-\/2 min.

(\"{}\+By default, hilapp Makefile uses clang++ installed in stage 1. You can also use g++ with \`{}make CXX=g++\`{}.\"{} Is this detail too complicated? Should just stick to clang in this part.)


\begin{DoxyItemize}
\item {\itshape NOTE\+: clang dev libraries are not installed in most supercomputer systems. However, if the system has x86\+\_\+64 processors (by far most common), you can use {\ttfamily make static} -\/command to build statically linked hilapp. Copy {\ttfamily hila/hilapp/build/hilapp} to directory {\ttfamily hila/hilapp/bin} on the target machine. Simpler approach for HPC platforms is use of singularity containers}
\end{DoxyItemize}

Test that hilapp works\+: \begin{DoxyVerb}./bin/hilapp --help
\end{DoxyVerb}
 

{\bfseries{Expected output }}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ ./bin/hilapp\ -\/-\/help}
\DoxyCodeLine{USAGE:\ hilapp\ [options]\ <source\ files>}
\DoxyCodeLine{}
\DoxyCodeLine{OPTIONS:}
\DoxyCodeLine{}
\DoxyCodeLine{Generic\ Options:}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ -\/-\/help\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Display\ available\ options\ (-\/-\/help-\/hidden\ for\ more)}
\DoxyCodeLine{\ \ -\/-\/help-\/list\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Display\ list\ of\ available\ options\ (-\/-\/help-\/list-\/hidden\ for\ more)}
\DoxyCodeLine{\ \ -\/-\/version\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Display\ the\ version\ of\ this\ program}
\DoxyCodeLine{}
\DoxyCodeLine{hilapp:}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ -\/-\/AVXinfo=<int>\ \ \ \ \ \ \ \ \ \ \ -\/\ AVX\ vectorization\ information\ level\ 0-\/2.\ 0\ quiet,\ 1\ not\ vectorizable\ loops,\ 2\ all\ loops}
\DoxyCodeLine{\ \ -\/D\ <macro[=value]>\ \ \ \ \ \ \ \ -\/\ Define\ name/macro\ for\ preprocessor}
\DoxyCodeLine{\ \ -\/I\ <directory>\ \ \ \ \ \ \ \ \ \ \ \ -\/\ Directory\ for\ include\ file\ search}
\DoxyCodeLine{\ \ -\/-\/allow-\/func-\/globals\ \ \ \ \ \ -\/\ Allow\ using\ global\ or\ extern\ variables\ in\ functions\ called\ from\ site\ loops.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ This\ will\ not\ work\ in\ kernelized\ code\ (for\ example\ GPUs)}
\DoxyCodeLine{\ \ -\/-\/check-\/init\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Insert\ checks\ that\ Field\ variables\ are\ appropriately\ initialized\ before\ use}
\DoxyCodeLine{\ \ -\/-\/comment-\/pragmas\ \ \ \ \ \ \ \ \ -\/\ Comment\ out\ '\#pragma\ hila'\ -\/pragmas\ in\ output}
\DoxyCodeLine{\ \ -\/-\/dump-\/ast\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Dump\ AST\ tree}
\DoxyCodeLine{\ \ -\/-\/function-\/spec-\/no-\/inline\ -\/\ Do\ not\ mark\ generated\ function\ specializations\ "{}inline"{}}
\DoxyCodeLine{\ \ -\/-\/gpu-\/slow-\/reduce\ \ \ \ \ \ \ \ \ -\/\ Use\ slow\ (but\ memory\ economical)\ reduction\ on\ gpus}
\DoxyCodeLine{\ \ -\/-\/ident-\/functions\ \ \ \ \ \ \ \ \ -\/\ Comment\ function\ call\ types\ in\ output}
\DoxyCodeLine{\ \ -\/-\/insert-\/includes\ \ \ \ \ \ \ \ \ -\/\ Insert\ all\ project\ \#include\ files\ in\ .cpt\ -\/files\ (portable)}
\DoxyCodeLine{\ \ -\/-\/method-\/spec-\/no-\/inline\ \ \ -\/\ Do\ not\ mark\ generated\ method\ specializations\ "{}inline"{}}
\DoxyCodeLine{\ \ -\/-\/no-\/include\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Do\ not\ insert\ any\ '\#include'-\/files\ (for\ debug,\ may\ not\ compile)}
\DoxyCodeLine{\ \ -\/-\/no-\/interleave\ \ \ \ \ \ \ \ \ \ \ -\/\ Do\ not\ interleave\ communications\ with\ computation}
\DoxyCodeLine{\ \ -\/-\/no-\/output\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ No\ output\ file,\ for\ syntax\ check}
\DoxyCodeLine{\ \ -\/o\ <filename>\ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Output\ file\ (default:\ <file>.cpt,\ write\ to\ stdout:\ -\/o\ -\/\ }
\DoxyCodeLine{\ \ -\/-\/syntax-\/only\ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Same\ as\ no-\/output}
\DoxyCodeLine{\ \ -\/-\/target:AVX\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Generate\ AVX\ vectorized\ loops}
\DoxyCodeLine{\ \ -\/-\/target:AVX512\ \ \ \ \ \ \ \ \ \ \ -\/\ Generate\ AVX512\ vectorized\ loops}
\DoxyCodeLine{\ \ -\/-\/target:CUDA\ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Generate\ CUDA\ kernels}
\DoxyCodeLine{\ \ -\/-\/target:HIP\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ Generate\ HIP\ kernels}
\DoxyCodeLine{\ \ -\/-\/target:openacc\ \ \ \ \ \ \ \ \ \ -\/\ Offload\ to\ GPU\ using\ openACC}
\DoxyCodeLine{\ \ -\/-\/target:openmp\ \ \ \ \ \ \ \ \ \ \ -\/\ Hybrid\ OpenMP\ -\/\ MPI}
\DoxyCodeLine{\ \ -\/-\/target:vanilla\ \ \ \ \ \ \ \ \ \ -\/\ Generate\ loops\ in\ place}
\DoxyCodeLine{\ \ -\/-\/target:vectorize=<int>\ \ -\/\ Generate\ vectorized\ loops\ with\ given\ vector\ size\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ For\ example\ -\/target:vectorize=32\ is\ equivalent\ to\ -\/target:AVX}
\DoxyCodeLine{\ \ -\/-\/verbosity=<int>\ \ \ \ \ \ \ \ \ -\/\ Verbosity\ level\ 0-\/2.\ \ Default\ 0\ (quiet)}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{index_building-hila-applications}{}\doxysubsection{\texorpdfstring{Building HILA applications}{Building HILA applications}}\label{index_building-hila-applications}
First we will try to build and run a health check test application with the default computing platform which is CPU with MPI enabled. To do so navigate to the applications folder and try\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{cd\ hila/applications/hila\_healthcheck}
\DoxyCodeLine{make\ -\/j4}
\DoxyCodeLine{./build/hila\_healthcheck}

\end{DoxyCode}




{\bfseries{Expected output }}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ ./build/hila\_healthcheck\ }
\DoxyCodeLine{-\/-\/-\/-\/-\/\ HILA\ ⩩\ lattice\ framework\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Running\ program\ ./build/hila\_healthcheck}
\DoxyCodeLine{with\ command\ line\ arguments\ ''}
\DoxyCodeLine{Code\ version:\ git\ SHA\ d0222bca}
\DoxyCodeLine{Compiled\ Jun\ \ 1\ 2023\ at\ 11:13:10}
\DoxyCodeLine{with\ options:\ EVEN\_SITES\_FIRST\ SPECIAL\_BOUNDARY\_CONDITIONS}
\DoxyCodeLine{Starting\ -\/-\/\ date\ Thu\ Jun\ \ 1\ 11:13:28\ 2023\ \ run\ time\ 8.328e-\/05s}
\DoxyCodeLine{No\ runtime\ limit\ given}
\DoxyCodeLine{GNU\ c-\/library\ performance:\ not\ returning\ allocated\ memory}
\DoxyCodeLine{-\/-\/-\/-\/-\/\ Reading\ file\ parameters\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{lattice\ size\ \ \ \ \ \ \ \ \ 256,256,256}
\DoxyCodeLine{random\ seed\ \ \ \ \ \ \ \ \ \ 0}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{LAYOUT:\ lattice\ size\ \ 256\ x\ 256\ x\ 256\ \ =\ \ 16777216\ sites}
\DoxyCodeLine{Dividing\ to\ 1\ nodes}
\DoxyCodeLine{}
\DoxyCodeLine{Sites\ on\ node:\ 256\ x\ 256\ x\ 256\ \ =\ \ 16777216}
\DoxyCodeLine{Processor\ layout:\ 1\ x\ 1\ x\ 1\ \ =\ \ 1\ nodes}
\DoxyCodeLine{Node\ remapping:\ NODE\_LAYOUT\_BLOCK\ with\ blocksize\ 4}
\DoxyCodeLine{Node\ block\ size\ 1\ 1\ 1\ \ block\ division\ 1\ 1\ 1}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Communication\ tests\ done\ -\/-\/\ date\ Thu\ Jun\ \ 1\ 11:13:31\ 2023\ \ run\ time\ 3.11s}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Random\ seed\ from\ time:\ 3871436182438}
\DoxyCodeLine{Using\ node\ random\ numbers,\ seed\ for\ node\ 0:\ 3871436182438}
\DoxyCodeLine{-\/-\/-\/\ Complex\ reduction\ value\ (\ -\/2.7647453e-\/17,\ 5.5294928e-\/17\ )\ passed}
\DoxyCodeLine{-\/-\/-\/\ Vector\ reduction,\ sum\ (\ -\/7.1331829e-\/15,\ -\/1.4328816e-\/15\ )\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 37\ 211\ 27\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 251\ 220\ 47\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 250\ 249\ 134\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Maxloc\ is\ [\ 112\ 117\ 164\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Max\ value\ 2\ passed}
\DoxyCodeLine{-\/-\/-\/\ Minloc\ is\ [\ 192\ 135\ 27\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Min\ value\ -\/1\ passed}
\DoxyCodeLine{-\/-\/-\/\ Field\ set\_elements\ and\ get\_elements\ with\ 51\ coordinates\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteSelect\ size\ 51\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteValueSelect\ size\ 51\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteSelect\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteValueSelect\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteIndex\ passed}
\DoxyCodeLine{-\/-\/-\/\ 2-\/dimensional\ slice\ size\ 65536\ passed}
\DoxyCodeLine{-\/-\/-\/\ slice\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ 1-\/dimensional\ slice\ size\ 256\ passed}
\DoxyCodeLine{-\/-\/-\/\ slice\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ constant\ field\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ inverse\ transform\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 132\ 159\ 243\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 167\ 161\ 208\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 152\ 87\ 255\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 156\ 86\ 229\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 78\ 246\ 141\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ real\ to\ complex\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ complex\ to\ real\ passed}
\DoxyCodeLine{-\/-\/-\/\ Norm\ of\ field\ =\ 44434.862\ and\ FFT\ =\ 44434.862\ passed}
\DoxyCodeLine{-\/-\/-\/\ Norm\ of\ binned\ FFT\ =\ 44434.862\ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 100\ 220\ 7\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 193\ 10\ 49\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 235\ 241\ 96\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{TIMER\ REPORT:\ \ \ \ \ \ \ \ \ \ \ \ \ total(sec)\ \ \ \ \ \ \ \ \ \ calls\ \ \ \ \ time/call\ \ fraction}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{MPI\ broadcast\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 40\ \ \ \ \ \ 0.263\ μs\ \ \ 0.0000}
\DoxyCodeLine{MPI\ reduction\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 34\ \ \ \ \ \ 2.003\ μs\ \ \ 0.0000}
\DoxyCodeLine{FFT\ total\ time\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ 44.544\ \ \ \ \ \ \ \ \ \ \ \ \ 14\ \ \ \ \ \ 3.182\ s\ \ \ \ 0.6449}
\DoxyCodeLine{\ copy\ pencils\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 3.261\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ \ 0.217\ s\ \ \ \ 0.0472}
\DoxyCodeLine{\ MPI\ for\ pencils\ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 90\ \ \ \ \ \ 1.298\ μs\ \ \ 0.0000}
\DoxyCodeLine{\ FFT\ plan\ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.003\ \ \ \ \ \ \ \ \ \ \ \ \ 42\ \ \ \ \ 73.150\ μs\ \ \ 0.0000}
\DoxyCodeLine{\ copy\ fft\ buffers\ \ \ :\ \ \ \ \ \ \ \ \ \ 2.412\ \ \ \ \ \ \ \ 5505024\ \ \ \ \ \ 0.438\ μs\ \ \ 0.0349}
\DoxyCodeLine{\ FFT\ execute\ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 2.356\ \ \ \ \ \ \ \ 2752512\ \ \ \ \ \ 0.856\ μs\ \ \ 0.0341}
\DoxyCodeLine{\ pencil\ reshuffle\ \ \ :\ \ \ \ \ \ \ \ \ 12.967\ \ \ \ \ \ \ \ \ \ \ \ \ 30\ \ \ \ \ \ 0.432\ s\ \ \ \ 0.1878}
\DoxyCodeLine{\ save\ pencils\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ 26.043\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ \ 1.736\ s\ \ \ \ 0.3771}
\DoxyCodeLine{bin\ field\ time\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 9.014\ \ \ \ \ \ \ \ \ \ \ \ \ \ 7\ \ \ \ \ \ 1.288\ s\ \ \ \ 0.1305}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\ No\ communications\ done\ from\ node\ 0}
\DoxyCodeLine{Finishing\ -\/-\/\ date\ Thu\ Jun\ \ 1\ 11:14:37\ 2023\ \ run\ time\ 69.07s}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}

\end{DoxyCode}


{\bfseries{NOTE\+: Naturally the run time depends on your system}}

\end{adjustwidth}


And for running with multiple processes\+: \begin{DoxyVerb}mpirun -n 4 ./build/hila_healthcheck
\end{DoxyVerb}
 

{\bfseries{Expected output }}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ mpirun\ -\/n\ 4\ ./build/hila\_healthcheck}
\DoxyCodeLine{-\/-\/-\/-\/-\/\ HILA\ ⩩\ lattice\ framework\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Running\ program\ ./build/hila\_healthcheck}
\DoxyCodeLine{with\ command\ line\ arguments\ ''}
\DoxyCodeLine{Code\ version:\ git\ SHA\ d0222bca}
\DoxyCodeLine{Compiled\ Jun\ \ 1\ 2023\ at\ 11:13:10}
\DoxyCodeLine{with\ options:\ EVEN\_SITES\_FIRST\ SPECIAL\_BOUNDARY\_CONDITIONS}
\DoxyCodeLine{Starting\ -\/-\/\ date\ Thu\ Jun\ \ 1\ 11:18:22\ 2023\ \ run\ time\ 0.0001745s}
\DoxyCodeLine{No\ runtime\ limit\ given}
\DoxyCodeLine{GNU\ c-\/library\ performance:\ not\ returning\ allocated\ memory}
\DoxyCodeLine{-\/-\/-\/-\/-\/\ Reading\ file\ parameters\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{lattice\ size\ \ \ \ \ \ \ \ \ 256,256,256}
\DoxyCodeLine{random\ seed\ \ \ \ \ \ \ \ \ \ 0}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{LAYOUT:\ lattice\ size\ \ 256\ x\ 256\ x\ 256\ \ =\ \ 16777216\ sites}
\DoxyCodeLine{Dividing\ to\ 4\ nodes}
\DoxyCodeLine{}
\DoxyCodeLine{Sites\ on\ node:\ 256\ x\ 128\ x\ 128\ \ =\ \ 4194304}
\DoxyCodeLine{Processor\ layout:\ 1\ x\ 2\ x\ 2\ \ =\ \ 4\ nodes}
\DoxyCodeLine{Node\ remapping:\ NODE\_LAYOUT\_BLOCK\ with\ blocksize\ 4}
\DoxyCodeLine{Node\ block\ size\ 1\ 2\ 2\ \ block\ division\ 1\ 1\ 1}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Communication\ tests\ done\ -\/-\/\ date\ Thu\ Jun\ \ 1\ 11:18:23\ 2023\ \ run\ time\ 1.046s}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Random\ seed\ from\ time:\ 4184648360436}
\DoxyCodeLine{Using\ node\ random\ numbers,\ seed\ for\ node\ 0:\ 4184648360436}
\DoxyCodeLine{-\/-\/-\/\ Complex\ reduction\ value\ (\ -\/2.7539926e-\/17,\ 5.5079939e-\/17\ )\ passed}
\DoxyCodeLine{-\/-\/-\/\ Vector\ reduction,\ sum\ (\ 1.4328816e-\/15,\ -\/7.4627804e-\/15\ )\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 139\ 215\ 41\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 231\ 44\ 102\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 238\ 201\ 150\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Maxloc\ is\ [\ 80\ 69\ 74\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Max\ value\ 2\ passed}
\DoxyCodeLine{-\/-\/-\/\ Minloc\ is\ [\ 219\ 105\ 178\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Min\ value\ -\/1\ passed}
\DoxyCodeLine{-\/-\/-\/\ Field\ set\_elements\ and\ get\_elements\ with\ 51\ coordinates\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteSelect\ size\ 51\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteValueSelect\ size\ 51\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteSelect\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteValueSelect\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteIndex\ passed}
\DoxyCodeLine{-\/-\/-\/\ 2-\/dimensional\ slice\ size\ 65536\ passed}
\DoxyCodeLine{-\/-\/-\/\ slice\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ 1-\/dimensional\ slice\ size\ 256\ passed}
\DoxyCodeLine{-\/-\/-\/\ slice\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ constant\ field\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ inverse\ transform\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 239\ 139\ 86\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 218\ 12\ 247\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 94\ 206\ 99\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 34\ 78\ 96\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 221\ 224\ 199\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ real\ to\ complex\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ complex\ to\ real\ passed}
\DoxyCodeLine{-\/-\/-\/\ Norm\ of\ field\ =\ 44418.915\ and\ FFT\ =\ 44418.915\ passed}
\DoxyCodeLine{-\/-\/-\/\ Norm\ of\ binned\ FFT\ =\ 44418.915\ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 106\ 69\ 123\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 240\ 142\ 174\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 226\ 28\ 118\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{TIMER\ REPORT:\ \ \ \ \ \ \ \ \ \ \ \ \ total(sec)\ \ \ \ \ \ \ \ \ \ calls\ \ \ \ \ time/call\ \ fraction}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{MPI\ broadcast\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.002\ \ \ \ \ \ \ \ \ \ \ \ \ 40\ \ \ \ \ 49.358\ μs\ \ \ 0.0001}
\DoxyCodeLine{MPI\ reduction\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.289\ \ \ \ \ \ \ \ \ \ \ \ \ 34\ \ \ \ \ \ 8.508\ ms\ \ \ 0.0120}
\DoxyCodeLine{MPI\ post\ receive\ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ \ 4\ \ \ \ \ \ 1.782\ μs\ \ \ 0.0000}
\DoxyCodeLine{MPI\ start\ send\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ \ 4\ \ \ \ \ \ 3.923\ μs\ \ \ 0.0000}
\DoxyCodeLine{MPI\ wait\ receive\ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.001\ \ \ \ \ \ \ \ \ \ \ \ \ \ 4\ \ \ \ \ \ 0.277\ ms\ \ \ 0.0000}
\DoxyCodeLine{MPI\ wait\ send\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.002\ \ \ \ \ \ \ \ \ \ \ \ \ \ 4\ \ \ \ \ \ 0.404\ ms\ \ \ 0.0001}
\DoxyCodeLine{MPI\ send\ field\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.001\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ 67.812\ μs\ \ \ 0.0000}
\DoxyCodeLine{FFT\ total\ time\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ 14.922\ \ \ \ \ \ \ \ \ \ \ \ \ 14\ \ \ \ \ \ 1.066\ s\ \ \ \ 0.6182}
\DoxyCodeLine{\ copy\ pencils\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 1.941\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ \ 0.129\ s\ \ \ \ 0.0804}
\DoxyCodeLine{\ MPI\ for\ pencils\ \ \ \ :\ \ \ \ \ \ \ \ \ \ 1.644\ \ \ \ \ \ \ \ \ \ \ \ \ 90\ \ \ \ \ 18.263\ ms\ \ \ 0.0681}
\DoxyCodeLine{\ FFT\ plan\ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.006\ \ \ \ \ \ \ \ \ \ \ \ \ 42\ \ \ \ \ \ 0.140\ ms\ \ \ 0.0002}
\DoxyCodeLine{\ copy\ fft\ buffers\ \ \ :\ \ \ \ \ \ \ \ \ \ 1.164\ \ \ \ \ \ \ \ 1376256\ \ \ \ \ \ 0.846\ μs\ \ \ 0.0482}
\DoxyCodeLine{\ FFT\ execute\ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.933\ \ \ \ \ \ \ \ \ 688128\ \ \ \ \ \ 1.355\ μs\ \ \ 0.0386}
\DoxyCodeLine{\ pencil\ reshuffle\ \ \ :\ \ \ \ \ \ \ \ \ \ 7.246\ \ \ \ \ \ \ \ \ \ \ \ \ 30\ \ \ \ \ \ 0.242\ s\ \ \ \ 0.3002}
\DoxyCodeLine{\ save\ pencils\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 2.994\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ \ 0.200\ s\ \ \ \ 0.1240}
\DoxyCodeLine{bin\ field\ time\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 2.792\ \ \ \ \ \ \ \ \ \ \ \ \ \ 7\ \ \ \ \ \ 0.399\ s\ \ \ \ 0.1157}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\ COMMS\ from\ node\ 0:\ 4\ done,\ 0(0\%)\ optimized\ away}
\DoxyCodeLine{Finishing\ -\/-\/\ date\ Thu\ Jun\ \ 1\ 11:18:46\ 2023\ \ run\ time\ 24.14s}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}

\end{DoxyCode}
 {\bfseries{NOTE\+: Naturally the run time depends on your system}}

\end{adjustwidth}


Now we can try to perform the same health check by targeting a differing computing platform with\+: \begin{DoxyVerb}make ARCH=<platform>
\end{DoxyVerb}
 where ARCH can take the following values\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ ARCH=   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ ARCH=   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-2}
\endhead
{\ttfamily vanilla}   &default CPU implementation    \\\cline{1-2}
{\ttfamily AVX2}   &AVX vectorization optimized program using \href{https://github.com/vectorclass}{\texttt{ {\itshape vectorclass}}}    \\\cline{1-2}
{\ttfamily openmp}   &Open\+MP parallelized program    \\\cline{1-2}
{\ttfamily cuda}   &Parallel \href{https://developer.nvidia.com/cuda-toolkit}{\texttt{ CUDA}} program    \\\cline{1-2}
{\ttfamily hip}   &Parallel \href{https://docs.amd.com/bundle/HIP-Programming-Guide-v5.3/page/Introduction_to_HIP_Programming_Guide.html}{\texttt{ HIP}}   \\\cline{1-2}
\end{longtabu}


TODO\+: add dependencies to table

For cuda compilation one needs to define their CUDA version and architercure either as environment variables or during the make process\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{export\ CUDA\_VERSION=11.6}
\DoxyCodeLine{export\ CUDA\_ARCH=61}
\DoxyCodeLine{make\ ARCH=cuda}
\DoxyCodeLine{or}
\DoxyCodeLine{make\ ARCH=cuda\ CUDA\_VERSION=11.6\ CUDA\_ARCH=61}

\end{DoxyCode}
 {\itshape NOTE\+: Default cuda version is 11.\+6 and compute architecture is sm\+\_\+61}

Now if we execute the cuda version one should expect the following output



{\bfseries{Expected output }}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ ./build/hila\_healthcheck\ }
\DoxyCodeLine{GPU\ devices\ accessible\ from\ node\ 0:\ 1}
\DoxyCodeLine{-\/-\/-\/-\/-\/\ HILA\ ⩩\ lattice\ framework\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Running\ program\ ./build/hila\_healthcheck}
\DoxyCodeLine{with\ command\ line\ arguments\ ''}
\DoxyCodeLine{Code\ version:\ git\ SHA\ df945bff}
\DoxyCodeLine{Compiled\ Jun\ \ 2\ 2023\ at\ 12:57:25}
\DoxyCodeLine{with\ options:\ EVEN\_SITES\_FIRST\ SPECIAL\_BOUNDARY\_CONDITIONS}
\DoxyCodeLine{Starting\ -\/-\/\ date\ Fri\ Jun\ \ 2\ 12:58:32\ 2023\ \ run\ time\ 0.08375s}
\DoxyCodeLine{No\ runtime\ limit\ given}
\DoxyCodeLine{Using\ thread\ blocks\ of\ size\ 256\ threads}
\DoxyCodeLine{Using\ GPU\_AWARE\_MPI}
\DoxyCodeLine{ReductionVector\ with\ atomic\ operations\ (GPU\_VECTOR\_REDUCTION\_THREAD\_BLOCKS=0)}
\DoxyCodeLine{CUDA\ driver\ version:\ 12010,\ runtime\ 12010}
\DoxyCodeLine{CUDART\_VERSION\ 12010}
\DoxyCodeLine{Device\ on\ node\ rank\ 0\ device\ 0:}
\DoxyCodeLine{\ \ NVIDIA\ GeForce\ GTX\ 1080\ \ capability:\ 6.1}
\DoxyCodeLine{\ \ Global\ memory:\ \ \ 8113MB}
\DoxyCodeLine{\ \ Shared\ memory:\ \ \ 48kB}
\DoxyCodeLine{\ \ Constant\ memory:\ 64kB}
\DoxyCodeLine{\ \ Block\ registers:\ 65536}
\DoxyCodeLine{\ \ Warp\ size:\ \ \ \ \ \ \ \ \ 32}
\DoxyCodeLine{\ \ Threads\ per\ block:\ 1024}
\DoxyCodeLine{\ \ Max\ block\ dimensions:\ [\ 1024,\ 1024,\ 64\ ]}
\DoxyCodeLine{\ \ Max\ grid\ dimensions:\ \ [\ 2147483647,\ 65535,\ 65535\ ]}
\DoxyCodeLine{Threads\ in\ use:\ 256}
\DoxyCodeLine{OpenMPI\ library\ does\ not\ support\ CUDA-\/Aware\ MPI}
\DoxyCodeLine{GPU\_AWARE\_MPI\ is\ defined\ -\/-\/\ THIS\ MAY\ CRASH\ IN\ MPI}
\DoxyCodeLine{GNU\ c-\/library\ performance:\ not\ returning\ allocated\ memory}
\DoxyCodeLine{-\/-\/-\/-\/-\/\ Reading\ file\ parameters\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{lattice\ size\ \ \ \ \ \ \ \ \ 256,256,256}
\DoxyCodeLine{random\ seed\ \ \ \ \ \ \ \ \ \ 0}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{LAYOUT:\ lattice\ size\ \ 256\ x\ 256\ x\ 256\ \ =\ \ 16777216\ sites}
\DoxyCodeLine{Dividing\ to\ 1\ nodes}
\DoxyCodeLine{}
\DoxyCodeLine{Sites\ on\ node:\ 256\ x\ 256\ x\ 256\ \ =\ \ 16777216}
\DoxyCodeLine{Processor\ layout:\ 1\ x\ 1\ x\ 1\ \ =\ \ 1\ nodes}
\DoxyCodeLine{Node\ remapping:\ NODE\_LAYOUT\_BLOCK\ with\ blocksize\ 4}
\DoxyCodeLine{Node\ block\ size\ 1\ 1\ 1\ \ block\ division\ 1\ 1\ 1}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Communication\ tests\ done\ -\/-\/\ date\ Fri\ Jun\ \ 2\ 12:58:34\ 2023\ \ run\ time\ 1.827s}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{Random\ seed\ from\ time:\ 7145975945297229}
\DoxyCodeLine{Using\ node\ random\ numbers,\ seed\ for\ node\ 0:\ 7145975945297229}
\DoxyCodeLine{GPU\ random\ number\ generator\ initialized}
\DoxyCodeLine{GPU\ random\ number\ thread\ blocks:\ 32\ of\ size\ 256\ threads}
\DoxyCodeLine{-\/-\/-\/\ Complex\ reduction\ value\ (\ -\/3.9112593e-\/17,\ -\/3.2797116e-\/18\ )\ passed}
\DoxyCodeLine{-\/-\/-\/\ Vector\ reduction,\ sum\ (\ -\/7.1331829e-\/15,\ -\/1.3218593e-\/15\ )\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 187\ 200\ 25\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 70\ 161\ 70\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Setting\ and\ reading\ a\ value\ at\ [\ 197\ 191\ 182\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Maxloc\ is\ [\ 13\ 45\ 107\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Max\ value\ 2\ passed}
\DoxyCodeLine{-\/-\/-\/\ Minloc\ is\ [\ 33\ 24\ 224\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Min\ value\ -\/1\ passed}
\DoxyCodeLine{-\/-\/-\/\ Field\ set\_elements\ and\ get\_elements\ with\ 51\ coordinates\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteSelect\ size\ 51\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteValueSelect\ size\ 51\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteSelect\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteValueSelect\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ SiteIndex\ passed}
\DoxyCodeLine{-\/-\/-\/\ 2-\/dimensional\ slice\ size\ 65536\ passed}
\DoxyCodeLine{-\/-\/-\/\ slice\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ 1-\/dimensional\ slice\ size\ 256\ passed}
\DoxyCodeLine{-\/-\/-\/\ slice\ content\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ constant\ field\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ inverse\ transform\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 202\ 153\ 38\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 185\ 196\ 66\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 222\ 252\ 82\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 214\ 47\ 8\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ of\ wave\ vector\ [\ 108\ 142\ 205\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ real\ to\ complex\ passed}
\DoxyCodeLine{-\/-\/-\/\ FFT\ complex\ to\ real\ passed}
\DoxyCodeLine{-\/-\/-\/\ Norm\ of\ field\ =\ 44465.9\ and\ FFT\ =\ 44465.9\ passed}
\DoxyCodeLine{-\/-\/-\/\ Norm\ of\ binned\ FFT\ =\ 44465.9\ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 175\ 117\ 16\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 129\ 107\ 153\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{-\/-\/-\/\ Binning\ test\ at\ vector\ [\ 237\ 7\ 157\ ]\ passed}
\DoxyCodeLine{-\/-\/-\/\ Spectral\ density\ test\ with\ above\ vector\ \ passed}
\DoxyCodeLine{TIMER\ REPORT:\ \ \ \ \ \ \ \ \ \ \ \ \ total(sec)\ \ \ \ \ \ \ \ \ \ calls\ \ \ \ \ time/call\ \ fraction}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{MPI\ broadcast\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 40\ \ \ \ \ \ 0.095\ μs\ \ \ 0.0000}
\DoxyCodeLine{MPI\ reduction\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 34\ \ \ \ \ \ 0.767\ μs\ \ \ 0.0000}
\DoxyCodeLine{FFT\ total\ time\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 4.149\ \ \ \ \ \ \ \ \ \ \ \ \ 14\ \ \ \ \ \ 0.296\ s\ \ \ \ 0.6021}
\DoxyCodeLine{\ copy\ pencils\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ \ 2.560\ μs\ \ \ 0.0000}
\DoxyCodeLine{\ MPI\ for\ pencils\ \ \ \ :\ \ \ \ \ \ \ \ \ \ 4.490\ \ \ \ \ \ \ \ \ \ \ \ \ 90\ \ \ \ \ 49.885\ ms\ \ \ 0.6515}
\DoxyCodeLine{\ FFT\ plan\ \ \ \ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.016\ \ \ \ \ \ \ \ \ \ \ \ \ \ 1\ \ \ \ \ 16.047\ ms\ \ \ 0.0023}
\DoxyCodeLine{\ copy\ fft\ buffers\ \ \ :\ \ \ \ \ \ \ \ \ \ 0.001\ \ \ \ \ \ \ \ \ \ \ \ \ 84\ \ \ \ \ \ 6.129\ μs\ \ \ 0.0001}
\DoxyCodeLine{\ FFT\ execute\ \ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.018\ \ \ \ \ \ \ \ \ \ \ \ \ 42\ \ \ \ \ \ 0.433\ ms\ \ \ 0.0026}
\DoxyCodeLine{\ pencil\ reshuffle\ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 30\ \ \ \ \ \ 3.821\ μs\ \ \ 0.0000}
\DoxyCodeLine{\ save\ pencils\ \ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.000\ \ \ \ \ \ \ \ \ \ \ \ \ 15\ \ \ \ \ \ 3.851\ μs\ \ \ 0.0000}
\DoxyCodeLine{bin\ field\ time\ \ \ \ \ \ :\ \ \ \ \ \ \ \ \ \ 0.208\ \ \ \ \ \ \ \ \ \ \ \ \ \ 7\ \ \ \ \ 29.777\ ms\ \ \ 0.0302}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\ No\ communications\ done\ from\ node\ 0}
\DoxyCodeLine{}
\DoxyCodeLine{GPU\ Memory\ pool\ statistics\ from\ node\ 0:}
\DoxyCodeLine{\ \ \ Total\ pool\ size\ 3459.87\ MB}
\DoxyCodeLine{\ \ \ \#\ of\ allocations\ 268\ \ real\ allocs\ 17\%}
\DoxyCodeLine{\ \ \ Average\ free\ list\ search\ 6.3\ steps}
\DoxyCodeLine{\ \ \ Average\ free\ list\ size\ 16\ items}
\DoxyCodeLine{}
\DoxyCodeLine{Finishing\ -\/-\/\ date\ Fri\ Jun\ \ 2\ 12:58:39\ 2023\ \ run\ time\ 6.891s}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}

\end{DoxyCode}
 {\bfseries{NOTE\+: Naturally the run time depends on your system}}

\end{adjustwidth}


Additionally we have some ARCH values tuned for specific HPC platforms\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ ARCH   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ ARCH   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-2}
\endhead
{\ttfamily lumi}   &CPU-\/\+MPI implementation for LUMI supercomputer    \\\cline{1-2}
{\ttfamily lumi-\/hip}   &GPU-\/\+MPI implementation for LUMI supercomputer using HIP    \\\cline{1-2}
{\ttfamily mahti}   &CPU-\/\+MPI implementation for MAHTI supercomputer    \\\cline{1-2}
{\ttfamily mahti-\/cuda}   &GPU-\/\+MPI implementation for MAHTI supercomputer using CUDA   \\\cline{1-2}
\end{longtabu}


We will discuss the computing platforms more in the creating a hila application guide.\hypertarget{index_user-guide}{}\doxysection{\texorpdfstring{User guide}{User guide}}\label{index_user-guide}
Now that HILA has been built successfully, the next step is to build your first HILA application\+: \doxysectlink{md_docs_2guide_2hila__applications}{hila application guide}{0}

After building your first HILA application one can move on to the comprehensive guide, which describes everything that HILA has to offer\+: \doxysectlink{md_docs_2guide_2hila__functionality}{comprehensive guide}{0} 